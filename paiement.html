<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paiement s√©curis√©</title>
  <link href="styles.css" rel="stylesheet" />
</head>
<body>
  <header class="header">
    <nav class="nav">
      <a class="cta" href="index.html">Accueil</a>
      <a class="cta" href="signup.html">S'inscrire</a>
      <a class="cta" href="login.html">Connexion</a>
    </nav>
  </header>

  <main>
    <section class="paybox">
      <h1>Paiement s√©curis√© avec PayPal</h1>
      <p>Cliquez sur le bouton ci-dessous pour r√©gler en toute s√©curit√©.</p>
      <div id="paypal-button-container"></div>
      <p class="note">Le paiement est trait√© c√¥t√© serveur via Netlify Functions et cr√©dit√© sur votre compte PayPal Business.</p>
    </section>
  </main>

  <!-- SDK PayPal -->
  <script src="https://www.paypal.com/sdk/js?currency=CHF"></script>
  <script>
    paypal.Buttons({
      createOrder: function() {
        return fetch("/api/create-order", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ amount: "49.00" }) // üí∞ tu peux changer le prix ici
        })
        .then(res => res.json())
        .then(order => order.id);
      },
      onApprove: function(data) {
        return fetch("/api/capture-order", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ orderID: data.orderID })
        })
        .then(res => res.json())
        .then(details => {
          alert("Merci " + details.payer.name.given_name + ", paiement r√©ussi !");
        });
      }
    }).render("#paypal-button-container");
  </script>
</body>
</html>
